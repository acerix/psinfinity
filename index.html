<!DOCTYPE html>
<html lang='en'>
<head>
<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<title>Psinfinity</title>
<style>
html {
  box-sizing: border-box;
}
*, *:before, *:after {
  box-sizing: inherit;
}
body {
  overflow: hidden;
  background-color: #202;
  color: #ece;
}
</style>
</head>
<body>
<script src='//cdnjs.cloudflare.com/ajax/libs/tone/13.3.11/Tone.min.js'></script>
<script src='//cdnjs.cloudflare.com/ajax/libs/seedrandom/2.4.4/seedrandom.min.js'></script>
<script src='//cdnjs.cloudflare.com/ajax/libs/seedrandom/2.4.4/lib/alea.min.js'></script>
<script type='module'>
'set strict'

// Main
import {Psinfinity} from './src/Psinfinity.mjs'

// Plugins
import {sParams} from './plugins/sParams.mjs'
import {pPanel} from './plugins/pPanel.mjs'

// Instruments
import {pKick} from './instruments/pKick.mjs'
import {pSnare} from './instruments/pSnare.mjs'
import {pHat} from './instruments/pHat.mjs'
import {pBass} from './instruments/pBass.mjs'
import {pSynth} from './instruments/pSynth.mjs'
import {pClips} from './instruments/pClips.mjs'
import {pFX} from './instruments/pFX.mjs'

window.onload = function() {
  var psinfinity = new Psinfinity({
    plugins: {
      'params': new sParams({
        onChange: {
          'bpm': function(v) {
            Tone.Transport.bpm.value = parseInt(v)
          },
          'key': function(v) {
            psinfinity.key = psinfinity.noteToInt(v)
            psinfinity.params.key = psinfinity.intToNote(psinfinity.key)
            psinfinity.updateParams()
          },
          'seed': function(v) {
            location.reload()
          },
        },
      }),
      'panel': new pPanel(),
    },
    instruments: {
      'kick': new pKick(),
      'hat': new pHat(),
      'snare': new pSnare(),
      'bass': new pBass(),
      'synth': new pSynth(),
      'clips': new pClips(),
      'fx': new pFX(),
    },
  })
}

</script>
<a href="./">Randomize</a>
</body>
</html>
